<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Arogya AI">
    <meta name="theme-color" content="#2563eb">
    <meta name="msapplication-TileColor" content="#2563eb">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-status-bar-style" content="black-translucent">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Arogya AI - Your Personal Health Co-Pilot</title>
    <meta name="description" content="Arogya AI - Your 24/7 personal health companion providing AI-powered health consultations, traditional remedies, and comprehensive health reports.">
    <meta name="keywords" content="AI health, medical consultation, traditional remedies, health assessment, telemedicine">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
    <script>
        // Ensure jsPDF is available globally
        window.addEventListener('DOMContentLoaded', function() {
            if (typeof window.jspdf !== 'undefined') {
                // jsPDF already available
            } else if (typeof jsPDF !== 'undefined') {
                window.jspdf = { jsPDF: jsPDF };
            }

            // Mobile-specific optimizations
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                // Add mobile class
                document.body.classList.add('mobile-device');
                
                // Prevent zoom on input focus
                const inputs = document.querySelectorAll('input, select, textarea');
                inputs.forEach(input => {
                    input.addEventListener('focus', function() {
                        const viewport = document.querySelector('meta[name="viewport"]');
                        viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');
                    });
                });

                // Handle iOS Safari bottom bar
                if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
                    const setViewportHeight = () => {
                        const vh = window.innerHeight * 0.01;
                        document.documentElement.style.setProperty('--vh', `${vh}px`);
                    };
                    
                    setViewportHeight();
                    window.addEventListener('resize', setViewportHeight);
                    window.addEventListener('orientationchange', () => {
                        setTimeout(setViewportHeight, 100);
                    });
                }
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>Arogya AI</h1>
                <div class="tagline">
                    <p>Your Personal Health Co-Pilot</p>
                    <p class="subtitle">AI-Powered Health Consultation & Traditional Remedies</p>
                </div>
            </div>
        </header>

        <!-- Language Selection -->
        <div class="language-selector">
            <label for="language" id="languageLabel">Choose Language / ‡§≠‡§æ‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç:</label>
            <select id="language" onchange="changeLanguage()">
                <option value="english">English</option>
                <option value="hindi">‡§π‡§ø‡§Ç‡§¶‡•Ä (Hindi)</option>
                <option value="marathi">‡§Æ‡§∞‡§æ‡§†‡•Ä (Marathi)</option>
                <option value="kannada">‡≤ï‡≤®‡≥ç‡≤®‡≤° (Kannada)</option>
            </select>
        </div>

        <!-- Emergency Alert -->
        <div class="emergency-alert" id="emergencyAlert" style="display: none;">
            <div class="alert-content">
                <i class="fas fa-exclamation-triangle"></i>
                <div class="alert-text">
                    <h3>‚ö†Ô∏è EMERGENCY DETECTED</h3>
                    <p id="emergencyText">This may be an emergency. Please seek immediate medical help or go to the nearest hospital.</p>
                    <div class="emergency-numbers">
                        <span>Emergency: 102/108</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Container -->
        <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
                <div class="message ai-message">
                    <div class="message-avatar">
                        <i class="fas fa-user-md"></i>
                    </div>
                    <div class="message-content">
                        <p id="welcomeMessage">Namaste! I'm Dr. Arogya, your personal health companion. How can I help you today?</p>
                    </div>
                </div>
            </div>

            <!-- User Info Collection -->
            <div class="user-info-section" id="userInfoSection">
                <div class="info-card">
                    <h3 id="infoTitle">Let me know you better</h3>
                    <div class="info-grid">
                        <input type="text" id="userName" placeholder="Your Name">
                        <input type="number" id="userAge" placeholder="Age" min="1" max="120">
                        <select id="userGender">
                            <option value="">Select Gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                        <input type="text" id="userCity" placeholder="City">
                    </div>
                    <button onclick="saveUserInfo()" class="save-info-btn" id="continueBtn">Continue</button>
                </div>
            </div>

            <!-- Chat Input -->
            <div class="chat-input-container">
                <div class="chat-input">
                    <input type="text" id="messageInput" placeholder="Type your message..." onkeypress="handleKeyPress(event)">
                    <button onclick="sendMessage()" id="sendButton">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons" id="actionButtons" style="display: none;">
            <button onclick="showReportPreview()" class="action-btn report-btn">
                <i class="fas fa-file-pdf"></i>
                <span id="reportBtnText">Generate Health Report</span>
            </button>
            <button onclick="startNewConsultation()" class="action-btn new-btn">
                <i class="fas fa-plus"></i>
                <span id="newConsultBtnText">New Consultation</span>
            </button>
        </div>

        <!-- Report Preview Modal -->
        <div class="modal-overlay" id="reportPreviewModal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-file-medical"></i> Health Report Preview</h3>
                    <button onclick="closeReportPreview()" class="modal-close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="report-preview" id="reportPreviewContent">
                        <!-- Report content will be inserted here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button onclick="closeReportPreview()" class="btn-secondary">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                    <button onclick="confirmGenerateReport()" class="btn-primary">
                        <i class="fas fa-download"></i> Download PDF Report
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p id="disclaimerText">üîí <strong>Disclaimer:</strong> Dr. Arogya is not a licensed doctor. Always consult a healthcare professional for serious conditions.</p>
            <p>Compliant with WHO, ICMR, MoHFW Guidelines | Emergency: 102/108</p>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <i class="fas fa-heartbeat"></i>
            <p id="loadingText">Dr. Arogya is thinking...</p>
        </div>
    </div>

    <!-- PDF Report Template (Hidden) -->
    <div id="reportTemplate" style="display: none;">
        <div class="pdf-report">
            <div class="report-header">
                <h1>ü©∫ AROGYA AI - EARLY DIAGNOSTIC REPORT</h1>
            </div>
            <div class="report-content">
                <div class="patient-info">
                    <p><strong>üë§ Name:</strong> <span id="reportName">_____________________</span> &nbsp;&nbsp;&nbsp;&nbsp; <strong>Location:</strong> <span id="reportLocation">_____________________</span></p>
                    <p><strong>Age:</strong> <span id="reportAge">_____</span> &nbsp;&nbsp;&nbsp;&nbsp; <strong>Gender:</strong> <span id="reportGender">_____________________</span></p>
                    <p><strong>üìÜ Date:</strong> <span id="reportDate"></span> &nbsp;&nbsp;&nbsp;&nbsp; <strong>üïí Time:</strong> <span id="reportTime"></span> &nbsp;&nbsp;&nbsp;&nbsp; <strong>üî¢ Health ID:</strong> <span id="reportId"></span></p>
                </div>

                <div class="symptoms-section">
                    <h3>üìã COLLECTED SYMPTOMS</h3>
                    <p><strong>‚Ä¢ Chief Complaint:</strong> <span id="reportSymptoms">_____________________</span></p>
                    <p><strong>‚Ä¢ Duration:</strong> <span id="reportDuration">_____</span> &nbsp;&nbsp;&nbsp;&nbsp; <strong>‚Ä¢ Severity (1-10):</strong> <span id="reportSeverity">_____</span> &nbsp;&nbsp;&nbsp;&nbsp; <strong>‚Ä¢ Frequency:</strong> <span id="reportFrequency">_____</span></p>
                    <p><strong>‚Ä¢ Associated Symptoms:</strong> <span id="reportAssociated">_____________________</span></p>
                    <p><strong>‚Ä¢ Medical History:</strong> <span id="reportHistory">_____________________</span></p>
                    <p><strong>‚Ä¢ Current Medications:</strong> <span id="reportMedications">_____________________</span></p>
                    <p><strong>‚Ä¢ Allergies:</strong> <span id="reportAllergies">_____________________</span></p>
                </div>

                <div class="ai-assessment">
                    <h3>ü§ñ AI PRELIMINARY ASSESSMENT</h3>
                    <p><strong>Possible Condition:</strong> <span id="reportCondition">_____________________</span></p>
                    <p><strong>AI Confidence Level:</strong> <span id="reportConfidence">_____%</span> &nbsp;&nbsp;&nbsp;&nbsp; <strong>Risk Level:</strong> <span id="reportRisk">‚ö™ Low ‚ö™ Moderate ‚ö™ High</span></p>
                    <p><strong>Emergency Alert:</strong> <span id="reportEmergency">‚ö™ None ‚ö™ Monitor Closely ‚ö™ SEEK IMMEDIATE CARE</span></p>
                </div>

                <div class="remedies-section">
                    <h3>üåø ‡§¶‡§æ‡§¶‡•Ä ‡§Æ‡§æ‡§Å ‡§ï‡•á ‡§®‡•Å‡§∏‡•ç‡§ñ‡•á (TRADITIONAL REMEDIES)</h3>
                    <p><strong>1. Recommended Remedy:</strong> <span id="reportRemedy1">_____________________</span></p>
                    <p>&nbsp;&nbsp;&nbsp;<strong>Usage Instructions:</strong> <span id="reportInstructions1">_____________________</span></p>
                    <p><strong>2. Alternative Remedy:</strong> <span id="reportRemedy2">_____________________</span></p>
                    <p>&nbsp;&nbsp;&nbsp;<strong>Usage Instructions:</strong> <span id="reportInstructions2">_____________________</span></p>
                </div>

                <div class="doctor-section">
                    <h3>üë®‚Äç‚öïÔ∏è DOCTOR ANALYSIS & DIAGNOSIS</h3>
                    <p><strong>Doctor Name:</strong> _________________________ &nbsp;&nbsp;&nbsp;&nbsp; <strong>License No:</strong> _____________________</p>
                    <p><strong>Clinical Diagnosis:</strong> _____________________</p>
                    <p><strong>Prescribed Medications:</strong></p>
                    <p>_______________________________________________________________________</p>
                    <p>_______________________________________________________________________</p>
                    <p><strong>Additional Instructions/Follow-up:</strong></p>
                    <p>_______________________________________________________________________</p>
                    <p>_______________________________________________________________________</p>
                    <p><strong>Doctor Signature:</strong> _________________________ &nbsp;&nbsp;&nbsp;&nbsp; <strong>Date:</strong> _______________</p>
                </div>

                <div class="disclaimer">
                    <p><strong>üîí SAFETY DISCLAIMER:</strong> This AI report is for preliminary assessment only and NOT a substitute for professional medical diagnosis. Always consult a licensed healthcare provider.</p>
                    <p><strong>Arogya AI v1.0 | Compliant with WHO, ICMR, MoHFW Guidelines | Emergency: 102/108</strong></p>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js?v=6.0"></script>
</body>
</html>